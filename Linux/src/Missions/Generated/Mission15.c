//
//  Mission15.c
//
//  Finite state machine routines for "Mission15" mission
//
//  Copyright (C) 1998 Relic Entertainment Inc.
//  All rights reserved
//
//  This code was autogenerated from Mission15.kp by KAS2C Version 2.05sdl
//


#include "Mission15.h"  // prototypes and #includes for exposed game functions

extern AITeam *CurrentTeamP;
#define kasThisTeamPtr CurrentTeamP

//  for run-time scoping of symbols (variables, timers, etc.)
extern sdword CurrentMissionScope;
extern char CurrentMissionScopeName[];

//  for displaying localized strings
extern udword strCurLanguage;

static char *LSTRING_Location[] = {  // multilingual strings
	"CHAPEL PERILOUS",
	"Chapelle des Périls",
	"Gefahr im Verzug",
	"CAPILLA DEL PELIGRO",
	"CHAPEL PERILOUS", };

static char *LSTRING_LevelName[] = {  // multilingual strings
	"15 - Chapel Perilous",
	"15 - Chapelle des Périls",
	"15 - Gefahr im Verzug",
	"15 - Capilla del peligro",
	"15 - Chapel Perilous", };

static char *LSTRING_Objective1[] = {  // multilingual strings
	"Destroy the object",
	"Destruction de l'objet",
	"Das Objekt zerstören.",
	"Destruir el objeto",
	"Distruggi l'oggetto", };

static char *LSTRING_Hyperspace[] = {  // multilingual strings
	"                HYPERSPACE",
	"                HYPERESPACE",
	"        HYPERRAUMSPRUNG",
	"                HIPERESPACIO",
	" 				IPERSPAZIO", };

//
//  "initialize" code for Mission15 Dead FSM
//
void Init_Mission15_Dead(void)
{
	CurrentMissionScope = KAS_SCOPE_FSM;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	if (kasfTeamCount() > 0)
	{
	(kasfEnableAllAIFeatures(), 0);
	(kasfTeamGiveToAI(), 0);
	}
	
}


//
//  "watch" code for Mission15 Dead FSM
//
void Watch_Mission15_Dead(void)
{
	CurrentMissionScope = KAS_SCOPE_FSM;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	
}


//
//  "initialize" code for Mission15 Events FSM
//
void Init_Mission15_Events(void)
{
	CurrentMissionScope = KAS_SCOPE_FSM;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	kasJump("PreNIS", Init_Mission15_Events_PreNIS, Watch_Mission15_Events_PreNIS);
	return;
	
}


//
//  "watch" code for Mission15 Events FSM
//
void Watch_Mission15_Events(void)
{
	CurrentMissionScope = KAS_SCOPE_FSM;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	if (!kasfVarValueGet("_VIFONCE001") && (kasfShipsCount(kasGrowSelectionPtr("EnemyMShip")) == 0)) // "ifonce" #1
	{
	kasfVarCreateSet("_VIFONCE001", 1);
	kasJump("EvaluateWinner", Init_Mission15_Events_EvaluateWinner, Watch_Mission15_Events_EvaluateWinner);
	return;
	}
	if (!kasfVarValueGet("_VIFONCE002") && (kasfMsgReceived("HeadShotDestroyed"))) // "ifonce" #2
	{
	kasfVarCreateSet("_VIFONCE002", 1);
	(kasfObjectiveSet("DestroyObject", 1), 0);
	kasJump("EvaluateWinner", Init_Mission15_Events_EvaluateWinner, Watch_Mission15_Events_EvaluateWinner);
	return;
	}
	
}


//
//  "initialize" code for Mission15 Events PreNIS state
//
void Init_Mission15_Events_PreNIS(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	(kasfTimerCreateSetStart("LocationTimer", 19), 0);
	
}


//
//  "watch" code for Mission15 Events PreNIS state
//
void Watch_Mission15_Events_PreNIS(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	if (!kasfVarValueGet("_VIFONCE003") && (kasfTimerRemaining("LocationTimer") == 16)) // "ifonce" #3
	{
	kasfVarCreateSet("_VIFONCE003", 1);
	(kasfLocationCard(5000, LSTRING_Location[strCurLanguage]), 0);
	}
	if (!kasfVarValueGet("_VIFONCE004") && (kasfTimerRemaining("LocationTimer") == 13)) // "ifonce" #4
	{
	kasfVarCreateSet("_VIFONCE004", 1);
	(kasfSpeechEvent((701 + 2048 + 268435456), 0), 0);
	}
	if (!kasfVarValueGet("_VIFONCE005") && (kasfTimerRemaining("LocationTimer") == 6)) // "ifonce" #5
	{
	kasfVarCreateSet("_VIFONCE005", 1);
	(kasfMusicStop(2), 0);
	}
	if (!kasfVarValueGet("_VIFONCE006") && (kasfTimerRemaining("LocationTimer") == 4)) // "ifonce" #6
	{
	kasfVarCreateSet("_VIFONCE006", 1);
	(kasfWideScreenIn(90), 0);
	}
	if (!kasfVarValueGet("_VIFONCE007") && (kasfTimerExpiredDestroy("LocationTimer"))) // "ifonce" #7
	{
	kasfVarCreateSet("_VIFONCE007", 1);
	kasJump("PlayNIS", Init_Mission15_Events_PlayNIS, Watch_Mission15_Events_PlayNIS);
	return;
	}
	
}


//
//  "initialize" code for Mission15 Events PlayNIS state
//
void Init_Mission15_Events_PlayNIS(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	(kasfVarCreateSet("G_PlayNis", 9), 0);
	(kasfTimerCreate("HoldForIntel"), 0);
	(kasfVarCreateSet("FinishedNIS", 0), 0);
	
}


//
//  "watch" code for Mission15 Events PlayNIS state
//
void Watch_Mission15_Events_PlayNIS(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	if (!kasfVarValueGet("_VIFONCE008") && (kasfVarValueGet("G_Nis9Complete"))) // "ifonce" #8
	{
	kasfVarCreateSet("_VIFONCE008", 1);
	(kasfTimerSet("HoldForIntel", 7), 0);
	(kasfTimerStart("HoldForIntel"), 0);
	(kasfVarValueSet("FinishedNIS", 1), 0);
	}
	if (kasfTimerExpired("HoldForIntel") && kasfVarValueGet("FinishedNIS"))
	{
	(kasfTimerDestroy("HoldForIntel"), 0);
	kasJump("FIIntro1", Init_Mission15_Events_FIIntro1, Watch_Mission15_Events_FIIntro1);
	return;
	}
	
}


//
//  "initialize" code for Mission15 Events FIIntro1 state
//
void Init_Mission15_Events_FIIntro1(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	if (kasfRaceOfHuman() == 0)
	{
	(kasfSpeechEvent((702 + 4096 + 268435456), 0), 0);
	}
	else
	{
	(kasfSpeechEvent((703 + 4096 + 268435456), 0), 0);
	}
	(kasfTimerCreate("HoldForSM"), 0);
	
}


//
//  "watch" code for Mission15 Events FIIntro1 state
//
void Watch_Mission15_Events_FIIntro1(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	(kasfVarDestroy("IntelEvent"), 0);
	(kasfVarCreateSet("IntelEvent", kasfIntelEventEnded()), 0);
	if (!kasfVarValueGet("_VIFONCE009") && (kasfVarValueGet("IntelEvent"))) // "ifonce" #9
	{
	kasfVarCreateSet("_VIFONCE009", 1);
	(kasfTimerSet("HoldForSM", 5), 0);
	(kasfTimerStart("HoldForSM"), 0);
	}
	if (kasfTimerExpiredDestroy("HoldForSM"))
	{
	kasJump("FIIntroLBXIn", Init_Mission15_Events_FIIntroLBXIn, Watch_Mission15_Events_FIIntroLBXIn);
	return;
	}
	
}


//
//  "initialize" code for Mission15 Events FIIntroLBXIn state
//
void Init_Mission15_Events_FIIntroLBXIn(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	(kasfOtherKASPause(), 0);
	(kasfWideScreenIn(90), 0);
	(kasfTimerCreateSetStart("LetterboxInTimer", 4), 0);
	
}


//
//  "watch" code for Mission15 Events FIIntroLBXIn state
//
void Watch_Mission15_Events_FIIntroLBXIn(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	if (kasfTimerRemaining("LetterboxInTimer") == 2)
	{
	(kasfOpenSensors(120000), 0);
	(kasfUniversePause(), 0);
	}
	if (kasfTimerExpiredDestroy("LetterboxInTimer"))
	{
	kasJump("FIIntro2", Init_Mission15_Events_FIIntro2, Watch_Mission15_Events_FIIntro2);
	return;
	}
	
}


//
//  "initialize" code for Mission15 Events FIIntro2 state
//
void Init_Mission15_Events_FIIntro2(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	(kasfSpeechEvent((704 + 4096 + 268435456), 0), 0);
	(kasfTimerCreateSetStart("PingHeadshot", 1), 0);
	(kasfVarCreateSet("PingedHeadshot", 0), 0);
	
}


//
//  "watch" code for Mission15 Events FIIntro2 state
//
void Watch_Mission15_Events_FIIntro2(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	(kasfVarDestroy("IntelEvent"), 0);
	(kasfVarCreateSet("IntelEvent", kasfIntelEventEnded()), 0);
	if (kasfVarValueGet("IntelEvent") == 2)
	{
	if (kasfVarValueGet("PingedHeadshot") == 0)
	{
	(kasfTimerDestroy("PingHeadshot"), 0);
	(kasfPingAddShips(kasAITeamShipsPtr("Headshot"), "HeadshotAsteroidPing"), 0);
	}
	else
	{
	(kasfTutRemovePointer("HeadshotPointer"), 0);
	}
	(kasfObjectiveCreate("DestroyObject", LSTRING_Objective1[strCurLanguage], LSTRING_Objective1[strCurLanguage]), 0);
	kasJump("FIIntroLBXOut", Init_Mission15_Events_FIIntroLBXOut, Watch_Mission15_Events_FIIntroLBXOut);
	return;
	}
	else if (kasfVarValueGet("IntelEvent"))
	{
	(kasfTutRemovePointer("HeadshotPointer"), 0);
	(kasfObjectiveCreate("DestroyObject", LSTRING_Objective1[strCurLanguage], LSTRING_Objective1[strCurLanguage]), 0);
	kasJump("FIIntroLBXOut", Init_Mission15_Events_FIIntroLBXOut, Watch_Mission15_Events_FIIntroLBXOut);
	return;
	}
	if (!kasfVarValueGet("_VIFONCE010") && (kasfTimerExpiredDestroy("PingHeadshot"))) // "ifonce" #10
	{
	kasfVarCreateSet("_VIFONCE010", 1);
	(kasfPingAddShips(kasAITeamShipsPtr("Headshot"), "HeadshotAsteroidPing"), 0);
	(kasfTutSetPointerTargetShipSelection("HeadshotPointer", kasAITeamShipsPtr("Headshot")), 0);
	(kasfVarValueSet("PingedHeadshot", 1), 0);
	}
	
}


//
//  "initialize" code for Mission15 Events FIIntroLBXOut state
//
void Init_Mission15_Events_FIIntroLBXOut(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	(kasfTimerCreateSetStart("LetterboxOutTimer", 5), 0);
	
}


//
//  "watch" code for Mission15 Events FIIntroLBXOut state
//
void Watch_Mission15_Events_FIIntroLBXOut(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	if (!kasfVarValueGet("_VIFONCE011") && (kasfTimerRemaining("LetterboxOutTimer") == 4)) // "ifonce" #11
	{
	kasfVarCreateSet("_VIFONCE011", 1);
	(kasfUniverseUnpause(), 0);
	(kasfCloseSensors(1), 0);
	(kasfWideScreenOut(30), 0);
	(kasfOtherKASUnpause(), 0);
	}
	if (kasfTimerExpiredDestroy("LetterboxOutTimer"))
	{
	kasJump("Countdown", Init_Mission15_Events_Countdown, Watch_Mission15_Events_Countdown);
	return;
	}
	
}


//
//  "initialize" code for Mission15 Events Countdown state
//
void Init_Mission15_Events_Countdown(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	(kasfTimerCreateSetStart("EndofLevel", kasfVarValueGet("G_CountdownTime")), 0);
	(kasfMsgSendAll("StartedCountdown"), 0);
	(kasfVarValueSet("G_HeadshotDestroyed", 0), 0);
	
}


//
//  "watch" code for Mission15 Events Countdown state
//
void Watch_Mission15_Events_Countdown(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	if (kasfTimerRemaining("EndofLevel") == 1200 && kasfVarValueGet("G_HeadshotDestroyed") == 0)
	{
	(kasfSpeechEvent((705 + 4096 + 268435456), 0), 0);
	}
	if (kasfTimerRemaining("EndofLevel") == 900 && kasfVarValueGet("G_HeadshotDestroyed") == 0)
	{
	(kasfSpeechEvent((706 + 4096 + 268435456), 0), 0);
	}
	if (kasfTimerRemaining("EndofLevel") == 600 && kasfVarValueGet("G_HeadshotDestroyed") == 0)
	{
	(kasfSpeechEvent((707 + 4096 + 268435456), 0), 0);
	}
	if (kasfTimerRemaining("EndofLevel") == 300 && kasfVarValueGet("G_HeadshotDestroyed") == 0)
	{
	(kasfSpeechEvent((708 + 4096 + 268435456), 0), 0);
	}
	if (kasfTimerRemaining("EndofLevel") == 240 && kasfVarValueGet("G_HeadshotDestroyed") == 0)
	{
	(kasfSpeechEvent((709 + 4096 + 268435456), 0), 0);
	}
	if (kasfTimerRemaining("EndofLevel") == 180 && kasfVarValueGet("G_HeadshotDestroyed") == 0)
	{
	(kasfSpeechEvent((710 + 4096 + 268435456), 0), 0);
	}
	if (kasfTimerRemaining("EndofLevel") == 120 && kasfVarValueGet("G_HeadshotDestroyed") == 0)
	{
	(kasfSpeechEvent((711 + 4096 + 268435456), 0), 0);
	}
	if (kasfTimerRemaining("EndofLevel") == 60 && kasfVarValueGet("G_HeadshotDestroyed") == 0)
	{
	(kasfSpeechEvent((712 + 4096 + 268435456), 0), 0);
	}
	if (kasfTimerRemaining("EndofLevel") == 30 && kasfVarValueGet("G_HeadshotDestroyed") == 0)
	{
	(kasfSpeechEvent((735 + 4096 + 268435456), 0), 0);
	}
	if (kasfTimerRemaining("EndofLevel") == 10 && kasfVarValueGet("G_HeadshotDestroyed") == 0)
	{
	(kasfSpeechEvent((736 + 4096 + 268435456), 0), 0);
	}
	if (kasfTimerRemaining("EndofLevel") == 5 && kasfVarValueGet("G_HeadshotDestroyed") == 0)
	{
	(kasfSpeechEvent((713 + 2048 + 268435456), 0), 0);
	}
	if (kasfTimerExpiredDestroy("EndofLevel"))
	{
	kasJump("EvaluateWinner", Init_Mission15_Events_EvaluateWinner, Watch_Mission15_Events_EvaluateWinner);
	return;
	}
	
}


//
//  "initialize" code for Mission15 Events EvaluateWinner state
//
void Init_Mission15_Events_EvaluateWinner(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	(kasfTimerCreateSetStart("WonAndDone", 12), 0);
	
}


//
//  "watch" code for Mission15 Events EvaluateWinner state
//
void Watch_Mission15_Events_EvaluateWinner(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	if (!kasfVarValueGet("_VIFONCE012") && (kasfVarValueGet("G_HeadshotDestroyed") == 1)) // "ifonce" #12
	{
	kasfVarCreateSet("_VIFONCE012", 1);
	(kasfObjectiveSet("DestroyObject", 1), 0);
	}
	if (kasfShipsCount(kasGrowSelectionPtr("EnemyMShip")) == 0)
	{
	(kasfObjectiveDestroyAll(), 0);
	(kasfMissionFailed(), 0);
	kasFSMCreate("Dead", Init_Mission15_Dead, Watch_Mission15_Dead, kasThisTeamPtr);
	}
	if (!kasfVarValueGet("_VIFONCE013") && (kasfTimerExpiredDestroy("WonAndDone"))) // "ifonce" #13
	{
	kasfVarCreateSet("_VIFONCE013", 1);
	(kasfObjectiveCreate("Hyperspace", LSTRING_Hyperspace[strCurLanguage], LSTRING_Hyperspace[strCurLanguage]), 0);
	(kasfSpeechEvent((714 + 4096 + 268435456), 0), 0);
	}
	
}


//
//  "initialize" code for Mission15 HeadShot FSM
//
void Init_Mission15_HeadShot(void)
{
	CurrentMissionScope = KAS_SCOPE_FSM;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	
}


//
//  "watch" code for Mission15 HeadShot FSM
//
void Watch_Mission15_HeadShot(void)
{
	CurrentMissionScope = KAS_SCOPE_FSM;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	if (kasfMsgReceived("StartedCountdown"))
	{
	kasJump("Moving", Init_Mission15_HeadShot_Moving, Watch_Mission15_HeadShot_Moving);
	return;
	}
	if (!kasfVarValueGet("_VIFONCE014") && (kasfTeamCount() == 0)) // "ifonce" #14
	{
	kasfVarCreateSet("_VIFONCE014", 1);
	(kasfMsgSendAll("HeadShotDestroyed"), 0);
	(kasfVarValueSet("G_HeadshotDestroyed", 1), 0);
	(kasfStop(), 0);
	(kasfMusicStop(2), 0);
	kasFSMCreate("Dead", Init_Mission15_Dead, Watch_Mission15_Dead, kasThisTeamPtr);
	}
	
}


//
//  "initialize" code for Mission15 HeadShot Moving state
//
void Init_Mission15_HeadShot_Moving(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	(kasfGrowSelectionClear(kasGrowSelectionPtr("Mothership")), 0);
	if (kasfFindEnemyShipsOfType(kasGrowSelectionPtr("Mothership"), "Mothership") == 0)
	{
	(kasfMissionFailed(), 0);
	kasFSMCreate("Dead", Init_Mission15_Dead, Watch_Mission15_Dead, kasThisTeamPtr);
	}
	(kasfVarValueSet("G_Dist2MShip", kasfFindDistance(kasThisTeamsVectorPtr(), kasShipsVectorPtr("Mothership")) - 1500), 0);
	(kasfTeamSetMaxVelocity(kasfVarValueGet("G_Dist2MShip") / kasfVarValueGet("G_CountdownTime")), 0);
	(kasfMoveTo(kasVectorPtr("TowardsPoint")), 0);
	
}


//
//  "watch" code for Mission15 HeadShot Moving state
//
void Watch_Mission15_HeadShot_Moving(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	if (!kasfVarValueGet("_VIFONCE015") && (kasfUnderAttack(kasGrowSelectionPtr("FirstAttackingShips")) > 0)) // "ifonce" #15
	{
	kasfVarCreateSet("_VIFONCE015", 1);
	(kasfMusicStop(0), 0);
	(kasfMusicPlay(13), 0);
	}
	
}


//
//  "initialize" code for Mission15 Protection FSM
//
void Init_Mission15_Protection(void)
{
	CurrentMissionScope = KAS_SCOPE_FSM;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	kasJump("Guarding", Init_Mission15_Protection_Guarding, Watch_Mission15_Protection_Guarding);
	return;
	
}


//
//  "watch" code for Mission15 Protection FSM
//
void Watch_Mission15_Protection(void)
{
	CurrentMissionScope = KAS_SCOPE_FSM;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	if (!kasfVarValueGet("_VIFONCE016") && (kasfMsgReceived("HeadShotDestroyed"))) // "ifonce" #16
	{
	kasfVarCreateSet("_VIFONCE016", 1);
	kasJump("KillMShip", Init_Mission15_Protection_KillMShip, Watch_Mission15_Protection_KillMShip);
	return;
	}
	if (!kasfVarValueGet("_VIFONCE017") && (kasfTeamCount() == 0)) // "ifonce" #17
	{
	kasfVarCreateSet("_VIFONCE017", 1);
	kasFSMCreate("Dead", Init_Mission15_Dead, Watch_Mission15_Dead, kasThisTeamPtr);
	}
	
}


//
//  "initialize" code for Mission15 Protection Guarding state
//
void Init_Mission15_Protection_Guarding(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	if (kasfThisTeamIs(kasAITeamPtr("DefendersGuard")))
	{
	(kasfFormationWall(), 0);
	}
	else
	{
	(kasfFormationBroad(), 0);
	}
	(kasfTacticsNeutral(), 0);
	(kasfGuardShips(kasAITeamShipsPtr("HeadShot")), 0);
	
}


//
//  "watch" code for Mission15 Protection Guarding state
//
void Watch_Mission15_Protection_Guarding(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	(kasfGrowSelectionClear(kasGrowSelectionPtr("Evaluate")), 0);
	if (kasfUnderAttack(kasGrowSelectionPtr("Evaluate")) > 0 || kasfUnderAttackElsewhere(kasAITeamPtr("Headshot"), kasGrowSelectionPtr("Evaluate")) > 0 || kasfFindEnemiesNearby(kasGrowSelectionPtr("Evaluate"), 20000) > 0 || kasfFindEnemiesInside(kasVolumePtr("HeadshotPathArea"), kasGrowSelectionPtr("Evaluate"), 5000) > 0)
	{
	(kasfAttack(kasGrowSelectionPtr("Evaluate")), 0);
	kasJump("Retaliate", Init_Mission15_Protection_Retaliate, Watch_Mission15_Protection_Retaliate);
	return;
	}
	
}


//
//  "initialize" code for Mission15 Protection Retaliate state
//
void Init_Mission15_Protection_Retaliate(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	
}


//
//  "watch" code for Mission15 Protection Retaliate state
//
void Watch_Mission15_Protection_Retaliate(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	(kasfGrowSelectionClear(kasGrowSelectionPtr("Evaluate")), 0);
	if (kasfShipsOrder((&kasThisTeamPtr->shipList)) != 2)
	{
	if (kasfUnderAttack(kasGrowSelectionPtr("Evaluate")) > 0 || kasfUnderAttackElsewhere(kasAITeamPtr("HeadShot"), kasGrowSelectionPtr("Evaluate")) > 0 || kasfFindEnemiesNearby(kasGrowSelectionPtr("Evaluate"), 20000) > 0 || kasfFindEnemiesInside(kasVolumePtr("HeadshotPathArea"), kasGrowSelectionPtr("Evaluate"), 5000) > 0)
	{
	kasfShipsSelectIndex(kasGrowSelectionPtr("Evaluate"), kasGrowSelectionPtr("Evaluate"), 0);
	(kasfAttack(kasGrowSelectionPtr("Evaluate")), 0);
	}
	else
	{
	kasJump("Guarding", Init_Mission15_Protection_Guarding, Watch_Mission15_Protection_Guarding);
	return;
	}
	}
	if (kasfTeamHealthAverage() < 40)
	{
	(kasfTacticsEvasive(), 0);
	}
	else if (kasfTeamHealthAverage() < 75)
	{
	(kasfTacticsNeutral(), 0);
	}
	else
	{
	(kasfTacticsAggressive(), 0);
	}
	
}


//
//  "initialize" code for Mission15 Protection KillMShip state
//
void Init_Mission15_Protection_KillMShip(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	if (kasfShipsCount(kasGrowSelectionPtr("EnemyMShip")) == 0)
	{
	kasFSMCreate("Dead", Init_Mission15_Dead, Watch_Mission15_Dead, kasThisTeamPtr);
	}
	
}


//
//  "watch" code for Mission15 Protection KillMShip state
//
void Watch_Mission15_Protection_KillMShip(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	if (kasfShipsOrder((&kasThisTeamPtr->shipList)) != 2)
	{
	(kasfTacticsAggressive(), 0);
	if (kasfShipsSelectNonCapital(kasGrowSelectionPtr("Evaluate"), (&kasThisTeamPtr->shipList)) > 0)
	{
	(kasfKamikazeEveryone(kasGrowSelectionPtr("EnemyMShip")), 0);
	}
	else
	{
	(kasfAttack(kasGrowSelectionPtr("EnemyMShip")), 0);
	}
	}
	else if (kasfShipsSelectCapital(kasGrowSelectionPtr("Evaluate"), (&kasThisTeamPtr->shipList)) > 0)
	{
	(kasfMoveAttack(kasGrowSelectionPtr("EnemyMShip")), 0);
	}
	
}


//
//  "initialize" code for Mission15 Harrass FSM
//
void Init_Mission15_Harrass(void)
{
	CurrentMissionScope = KAS_SCOPE_FSM;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	(kasfTacticsEvasive(), 0);
	kasJump("Bother", Init_Mission15_Harrass_Bother, Watch_Mission15_Harrass_Bother);
	return;
	
}


//
//  "watch" code for Mission15 Harrass FSM
//
void Watch_Mission15_Harrass(void)
{
	CurrentMissionScope = KAS_SCOPE_FSM;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	if (!kasfVarValueGet("_VIFONCE018") && (kasfMsgReceived("HeadShotDestroyed"))) // "ifonce" #18
	{
	kasfVarCreateSet("_VIFONCE018", 1);
	kasJump("KillMShip", Init_Mission15_Harrass_KillMShip, Watch_Mission15_Harrass_KillMShip);
	return;
	}
	if (!kasfVarValueGet("_VIFONCE019") && (kasfTeamCount() == 0)) // "ifonce" #19
	{
	kasfVarCreateSet("_VIFONCE019", 1);
	kasFSMCreate("Dead", Init_Mission15_Dead, Watch_Mission15_Dead, kasThisTeamPtr);
	}
	
}


//
//  "initialize" code for Mission15 Harrass Bother state
//
void Init_Mission15_Harrass_Bother(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	if (kasfShipsSelectCapital(kasGrowSelectionPtr("Evaluate"), (&kasThisTeamPtr->shipList)) > 0)
	{
	(kasfFormationWall(), 0);
	}
	else
	{
	(kasfFormationClaw(), 0);
	}
	(kasfAttackHarass(), 0);
	
}


//
//  "watch" code for Mission15 Harrass Bother state
//
void Watch_Mission15_Harrass_Bother(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	(kasfGrowSelectionClear(kasGrowSelectionPtr("HEval")), 0);
	if (kasfShipsOrder((&kasThisTeamPtr->shipList)) != 2)
	{
	(kasfGrowSelectionClear(kasGrowSelectionPtr("HEval")), 0);
	if (kasfUnderAttack(kasGrowSelectionPtr("HEval")) > 0 || kasfUnderAttackElsewhere(kasAITeamPtr("HeadShot"), kasGrowSelectionPtr("HEval")) > 0 || kasfFindEnemiesNearTeam(kasGrowSelectionPtr("HEval"), 20000) > 0 || kasfFindEnemiesInside(kasVolumePtr("HeadshotPathArea"), kasGrowSelectionPtr("HEval"), 5000) > 0)
	{
	kasfShipsSelectIndex(kasGrowSelectionPtr("HEval"), kasGrowSelectionPtr("HEval"), 0);
	(kasfAttack(kasGrowSelectionPtr("HEval")), 0);
	}
	else
	{
	kasJump("Guard", Init_Mission15_Harrass_Guard, Watch_Mission15_Harrass_Guard);
	return;
	}
	}
	
}


//
//  "initialize" code for Mission15 Harrass Guard state
//
void Init_Mission15_Harrass_Guard(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	(kasfGuardShips(kasAITeamShipsPtr("HeadShot")), 0);
	
}


//
//  "watch" code for Mission15 Harrass Guard state
//
void Watch_Mission15_Harrass_Guard(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	(kasfGrowSelectionClear(kasGrowSelectionPtr("HEval")), 0);
	if (kasfUnderAttack(kasGrowSelectionPtr("HEval")) > 0 || kasfUnderAttackElsewhere(kasAITeamPtr("HeadShot"), kasGrowSelectionPtr("HEval")) > 0 || kasfFindEnemiesNearTeam(kasGrowSelectionPtr("HEval"), 20000) > 0 || kasfFindEnemiesInside(kasVolumePtr("HeadshotPathArea"), kasGrowSelectionPtr("HEval"), 5000) > 0)
	{
	kasfShipsSelectIndex(kasGrowSelectionPtr("HEval"), kasGrowSelectionPtr("HEval"), 0);
	(kasfAttack(kasGrowSelectionPtr("HEval")), 0);
	;
	kasJump("Bother", Init_Mission15_Harrass_Bother, Watch_Mission15_Harrass_Bother);
	return;
	}
	
}


//
//  "initialize" code for Mission15 Harrass KillMShip state
//
void Init_Mission15_Harrass_KillMShip(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	if (kasfShipsCount(kasGrowSelectionPtr("EnemyMShip")) == 0)
	{
	kasFSMCreate("Dead", Init_Mission15_Dead, Watch_Mission15_Dead, kasThisTeamPtr);
	}
	
}


//
//  "watch" code for Mission15 Harrass KillMShip state
//
void Watch_Mission15_Harrass_KillMShip(void)
{
	CurrentMissionScope = KAS_SCOPE_STATE;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	if (kasfShipsOrder((&kasThisTeamPtr->shipList)) != 2)
	{
	(kasfTacticsAggressive(), 0);
	if (kasfShipsSelectNonCapital(kasGrowSelectionPtr("Evaluate"), (&kasThisTeamPtr->shipList)) > 0)
	{
	(kasfKamikazeEveryone(kasGrowSelectionPtr("EnemyMShip")), 0);
	}
	else
	{
	(kasfAttack(kasGrowSelectionPtr("EnemyMShip")), 0);
	}
	}
	else if (kasfShipsSelectCapital(kasGrowSelectionPtr("Evaluate"), (&kasThisTeamPtr->shipList)) > 0)
	{
	(kasfMoveAttack(kasGrowSelectionPtr("EnemyMShip")), 0);
	}
	
}


//
//  "initialize" code for Mission15 WaitForCountDown FSM
//
void Init_Mission15_WaitForCountDown(void)
{
	CurrentMissionScope = KAS_SCOPE_FSM;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	
}


//
//  "watch" code for Mission15 WaitForCountDown FSM
//
void Watch_Mission15_WaitForCountDown(void)
{
	CurrentMissionScope = KAS_SCOPE_FSM;
	strcpy(CurrentMissionScopeName, kasThisTeamPtr->kasLabel);
	if (kasfMsgReceived("StartedCountdown"))
	{
	if (kasfThisTeamIs(kasAITeamPtr("Destroyers")) || kasfThisTeamIs(kasAITeamPtr("FrigatesGuard")) || kasfThisTeamIs(kasAITeamPtr("DefendersGuard")) || kasfThisTeamIs(kasAITeamPtr("CorvetteGuard")))
	{
	kasFSMCreate("Protection", Init_Mission15_Protection, Watch_Mission15_Protection, kasThisTeamPtr);
	}
	else if (kasfThisTeamIs(kasAITeamPtr("FrgHarrass")) || kasfThisTeamIs(kasAITeamPtr("InterceptorsHarrass")) || kasfThisTeamIs(kasAITeamPtr("CorvetteHarass")))
	{
	kasFSMCreate("Harrass", Init_Mission15_Harrass, Watch_Mission15_Harrass, kasThisTeamPtr);
	}
	}
	
}


//
//  "initialize" code for Mission15 mission
//
void Init_Mission15(void)
{
	CurrentMissionScope = KAS_SCOPE_MISSION;
	strcpy(CurrentMissionScopeName, "Mission15");
	(kasfVarCreateSet("G_HeadshotDestroyed", 0), 0);
	(kasfVarCreateSet("G_CountdownTime", 390), 0);
	(kasfVarCreateSet("G_Dist2MShip", 0), 0);
	kasFSMCreate("Events", Init_Mission15_Events, Watch_Mission15_Events, kasAITeamPtr("Events"));
	kasFSMCreate("HeadShot", Init_Mission15_HeadShot, Watch_Mission15_HeadShot, kasAITeamPtr("HeadShot"));
	kasFSMCreate("WaitForCountDown", Init_Mission15_WaitForCountDown, Watch_Mission15_WaitForCountDown, kasAITeamPtr("Destroyers"));
	kasFSMCreate("WaitForCountDown", Init_Mission15_WaitForCountDown, Watch_Mission15_WaitForCountDown, kasAITeamPtr("FrigatesGuard"));
	kasFSMCreate("WaitForCountDown", Init_Mission15_WaitForCountDown, Watch_Mission15_WaitForCountDown, kasAITeamPtr("DefendersGuard"));
	kasFSMCreate("WaitForCountDown", Init_Mission15_WaitForCountDown, Watch_Mission15_WaitForCountDown, kasAITeamPtr("FrgHarrass"));
	kasFSMCreate("WaitForCountDown", Init_Mission15_WaitForCountDown, Watch_Mission15_WaitForCountDown, kasAITeamPtr("InterceptorsHarrass"));
	kasFSMCreate("WaitForCountDown", Init_Mission15_WaitForCountDown, Watch_Mission15_WaitForCountDown, kasAITeamPtr("CorvetteGuard"));
	kasFSMCreate("WaitForCountDown", Init_Mission15_WaitForCountDown, Watch_Mission15_WaitForCountDown, kasAITeamPtr("CorvetteHarass"));
	(kasfGrowSelectionClear(kasGrowSelectionPtr("EnemyMShip")), 0);
	kasfFindEnemyShipsOfType(kasGrowSelectionPtr("EnemyMShip"), "Mothership");
	(kasfSaveLevel(15, LSTRING_LevelName[strCurLanguage]), 0);
	
}


//
//  "watch" code for Mission15 mission
//
void Watch_Mission15(void)
{
	CurrentMissionScope = KAS_SCOPE_MISSION;
	strcpy(CurrentMissionScopeName, "Mission15");
	if (!kasfVarValueGet("_VIFONCE020") && (kasfDoesPlayerHave("MassDrive10Kt"))) // "ifonce" #20
	{
	kasfVarCreateSet("_VIFONCE020", 1);
	(kasfAllowPlayerToResearch("Chassis2"), 0);
	}
	if ((kasfDoesPlayerHave("Chassis2")) && (kasfVarValueGet("SetMediumGuns") == 0))
	{
	(kasfAllowPlayerToResearch("MediumGuns"), 0);
	(kasfVarCreateSet("SetMediumGuns", 1), 0);
	}
	if (!kasfVarValueGet("_VIFONCE021") && (kasfDoesPlayerHave("Chassis1"))) // "ifonce" #21
	{
	kasfVarCreateSet("_VIFONCE021", 1);
	(kasfAllowPlayerToResearch("MassDrive10Kt"), 0);
	}
	
}


